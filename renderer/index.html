<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fleeting</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="app">
    <!-- 最左侧活动栏 -->
    <nav id="activity-bar">
      <div class="activity-item active" id="mode-public" title="闪记">
        📝
      </div>
      <div class="activity-item" id="mode-private" title="私密记录">
        🔒
      </div>
    </nav>

    <!-- 左侧侧边栏 -->
    <aside id="sidebar">
      <div class="sidebar-header">
        <span class="logo">📝 Fleeting</span>
      </div>
      <div class="sidebar-section-label">月份</div>
      <nav id="month-list"></nav>
      <div class="sidebar-section-label" id="tag-section-label" style="display:none">标签</div>
      <nav id="tag-list"></nav>
      <div style="flex: 1;"></div>
      <button id="open-dir-btn" title="打开存储目录">📂 打开存储目录</button>
      <button id="settings-btn" title="设置">⚙️ 设置</button>
    </aside>

    <!-- 右侧主区域 -->
    <main id="main">
      <div id="topbar">
        <div id="current-month-label"></div>
        <div id="search-wrap">
          <input id="search-input" type="text" placeholder="搜索内容或 #标签…" />
          <button id="search-clear" title="清除">✕</button>
        </div>
      </div>

      <!-- memo 列表 -->
      <div id="memo-list"></div>

      <!-- 输入区域固定在底部 -->
      <div id="input-area">
        <!-- 标签自动补全下拉（弹在输入框上方）-->
        <div id="tag-dropdown"></div>
        <div id="editor-wrap">
          <textarea id="editor" placeholder="写点什么… (Ctrl+Enter 发送，支持 Markdown)" rows="3"></textarea>
          <div id="editor-toolbar">
            <span class="hint">Ctrl+Enter 发送</span>
            <button id="submit-btn">发送</button>
          </div>
        </div>
      </div>
    </main>
    
    <!-- 密码弹窗 -->
    <div id="password-modal" class="modal-overlay" style="display:none;">
      <div class="modal-content" style="width: 320px;">
        <h3>私密记录</h3>
        <p class="setting-desc" style="margin-bottom:16px;">首次进入将设置密码，之后需要此密码才能解锁查看或记录。</p>
        <div class="input-group" style="margin-bottom: 20px;">
          <input type="password" id="private-pwd-input" placeholder="请输入密码..." />
        </div>
        <div class="modal-actions">
          <button id="cancel-pwd-btn" class="btn-cancel">取消</button>
          <button id="confirm-pwd-btn" class="btn-primary">确认</button>
        </div>
      </div>
    </div>

    <!-- 设置弹窗 -->
    <div id="settings-modal" class="modal-overlay" style="display:none;">
      <div class="modal-content" style="width:480px;max-height:80vh;overflow-y:auto;">
        <h3>设置</h3>
        <div class="setting-item">
          <label>数据存储目录</label>
          <div class="input-group">
            <input type="text" id="storage-dir-input" readonly />
            <button id="browse-dir-btn">浏览...</button>
          </div>
          <p class="setting-desc">支持配置为 iCloud 目录实现多端同步，数据完全本地化。</p>
        </div>
        <div class="setting-item">
          <label>自动备份</label>
          <div class="input-group">
            <span class="setting-inline-label">每</span>
            <input type="number" id="backup-interval-input" min="0" style="width:70px;" />
            <select id="backup-unit-select" style="width:56px;padding:6px 4px;border-radius:6px;border:1px solid var(--border);font-size:13px;">
              <option value="hour">小时</option>
              <option value="day">天</option>
            </select>
            <span class="setting-inline-label">备份一次（0 = 关闭）</span>
          </div>
          <div class="input-group" style="margin-top:8px;">
            <span class="setting-inline-label">保留最近</span>
            <input type="number" id="backup-keep-input" min="1" style="width:70px;" />
            <span class="setting-inline-label">次备份</span>
          </div>
          <p class="setting-desc">备份文件保存在存储目录下的 .backup 文件夹中。</p>
        </div>
        <div class="setting-item">
          <label style="display:flex;align-items:center;justify-content:space-between;">
            备份历史
            <button id="backup-now-btn" class="btn-secondary" style="font-size:12px;padding:3px 10px;">立即备份</button>
          </label>
          <div id="backup-list" style="max-height:180px;overflow-y:auto;border:1px solid var(--border);border-radius:6px;"></div>
        </div>
        <div class="modal-actions">
          <button id="close-settings-btn" class="btn-cancel">取消</button>
          <button id="save-settings-btn" class="btn-primary">保存并生效</button>
        </div>
      </div>
    </div>
  </div>

  <script src="../node_modules/marked/marked.min.js"></script>
  <script src="renderer.js"></script>
</body>
</html>
